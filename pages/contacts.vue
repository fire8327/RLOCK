<template>
    <div class="my-10 flex flex-col gap-7 w-full">
        <p class="w-full py-7 px-6 md:px-12 xl:px-[90px] bg-gradient-to-l from-[#48BBDE] to-[#B190F1] rounded-[25px] NeutralFace text-white text-2xl md:text-3xl xl:text-[32px]">контакты</p>
        <div class="flex max-lg:flex-col lg:items-start gap-5 px-6 md:px-12 xl:px-[90px]">
            <div class="flex flex-col gap-6 lg:gap-11 text-xl md:text-xl xl:text-2xl font-light lg:w-3/5">
                <p class="leading-[165.3%]">Если у вас возник вопрос по бронированию, пожалуйста, свяжитесь с нами по телефону или с помощью формы обратной связи.</p>
                <div class="flex flex-col gap-7">
                    <div class="flex items-center gap-4">
                        <img src="/images/icons/phone.png" alt="">
                        <NuxtLink to="tel:+ 7 (999) 234 45 67">+ 7 (999) 234 45 67</NuxtLink>
                    </div>
                    <div class="flex items-center gap-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">
                            <path d="M35.6302 7.45251H8.36849C7.15291 7.45251 5.98713 7.9354 5.12758 8.79494C4.26804 9.65448 3.78516 10.8203 3.78516 12.0358V31.9642C3.78516 33.1798 4.26804 34.3455 5.12758 35.2051C5.98713 36.0646 7.15291 36.5475 8.36849 36.5475H35.6302C36.8457 36.5475 38.0115 36.0646 38.8711 35.2051C39.7306 34.3455 40.2135 33.1798 40.2135 31.9642V12.0358C40.2135 10.8203 39.7306 9.65448 38.8711 8.79494C38.0115 7.9354 36.8457 7.45251 35.6302 7.45251ZM8.36849 9.28585H35.6302C36.3241 9.28385 36.9927 9.5462 37.5002 10.0196C38.0076 10.4929 38.3157 11.1418 38.3618 11.8342C33.8335 14.2542 29.2868 16.6558 24.7402 19.0758C24.125 19.4613 23.4743 19.7867 22.7968 20.0475C22.265 20.1525 21.7169 20.143 21.189 20.0197C20.6611 19.8964 20.1655 19.6622 19.7352 19.3325C17.1318 17.9575 14.5285 16.5642 11.9435 15.1892C9.85349 14.0892 7.72682 12.9708 5.63682 11.8525C5.67934 11.1572 5.98575 10.5043 6.49345 10.0272C7.00115 9.55021 7.67184 9.28502 8.36849 9.28585ZM38.3802 31.9642C38.3802 32.6935 38.0904 33.393 37.5747 33.9087C37.059 34.4244 36.3595 34.7142 35.6302 34.7142H8.36849C7.63914 34.7142 6.93967 34.4244 6.42395 33.9087C5.90822 33.393 5.61849 32.6935 5.61849 31.9642V13.9333C9.94516 16.2067 14.2535 18.5167 18.5802 20.8083C19.3532 21.2823 20.1854 21.6521 21.0552 21.9083C22.3282 22.1153 23.6329 21.8479 24.7218 21.1567C27.3802 19.7633 30.0202 18.3517 32.6785 16.9583C34.5852 15.9317 36.4735 14.9417 38.3802 13.9333V31.9642Z" fill="url(#paint0_linear_766_1995)"/>
                            <defs>
                                <linearGradient id="paint0_linear_766_1995" x1="4.97674" y1="7.45251" x2="40.6066" y2="9.96601" gradientUnits="userSpaceOnUse">
                                    <stop stop-color="#B98CF2"/>
                                    <stop offset="1" stop-color="#48BBDE"/>
                                </linearGradient>
                            </defs>
                        </svg>
                        <NuxtLink to="mailto:info@rlock.ru">info@rlock.ru</NuxtLink>
                    </div>
                    <div class="flex items-center gap-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none" class="shrink-0">
                            <path d="M7.33398 18.5955C7.33398 10.351 13.901 3.66669 22.0007 3.66669C30.1003 3.66669 36.6673 10.351 36.6673 18.5955C36.6673 26.7759 31.9868 36.3239 24.6828 39.7357C23.8433 40.1288 22.9276 40.3325 22.0007 40.3325C21.0737 40.3325 20.158 40.1288 19.3185 39.7357C12.0145 36.322 7.33398 26.7759 7.33398 18.5974V18.5955Z" stroke="url(#paint0_linear_766_2021)" stroke-width="2"/>
                            <path d="M22 23.8334C25.0376 23.8334 27.5 21.3709 27.5 18.3334C27.5 15.2958 25.0376 12.8334 22 12.8334C18.9624 12.8334 16.5 15.2958 16.5 18.3334C16.5 21.3709 18.9624 23.8334 22 23.8334Z" stroke="url(#paint1_linear_766_2021)" stroke-width="2"/>
                            <defs>
                                <linearGradient id="paint0_linear_766_2021" x1="8.29349" y1="3.66668" x2="37.0682" y2="4.96373" gradientUnits="userSpaceOnUse">
                                    <stop stop-color="#B98CF2"/>
                                    <stop offset="1" stop-color="#48BBDE"/>
                                </linearGradient>
                                    <linearGradient id="paint1_linear_766_2021" x1="16.8598" y1="12.8334" x2="27.638" y2="13.4407" gradientUnits="userSpaceOnUse">
                                    <stop stop-color="#B98CF2"/>
                                    <stop offset="1" stop-color="#48BBDE"/>
                                </linearGradient>
                            </defs>
                        </svg>
                        <p class="leading-[135.3%]">121596, г. Москва, муниципальный округ Можайский вн.тер.г., ул. Горбунова, д. 2, стр. 3, помещение 55/3</p>
                    </div>
                </div>
            </div>
            <div class="bg-gradient-to-br from-[#48BBDE] to-[#B190F1] rounded-[25px] p-[2px] lg:w-2/5">
                <div class="w-full h-full bg-white p-5 pb-6 flex flex-col gap-5 rounded-[25px]">
                    <div class="flex flex-col">
                        <p class="font-bold text-lg md:text-xl xl:text-2xl">Есть вопрос?</p>
                        <p class="font-light text-base md:text-lg xl:text-xl leading-[165.3%]">Заполните форму обратной связи и мы свяжемся с вами через 30 минут.</p>
                    </div>
                    <form @submit.prevent="submitForm" id="feedbackForm" class="flex flex-col gap-4 w-full">
                        <input required v-model="form.name" type="text" class="rounded-[10px] bg-[#EBEBEB] border border-[#B1B1B1] text-base py-2.5 px-5 placeholder-[#696969] focus:ring-0 focus:outline-none focus:appearance-none" placeholder="Ваше имя">
                        <input required v-model="form.email" type="email" class="rounded-[10px] bg-[#EBEBEB] border border-[#B1B1B1] text-base py-2.5 px-5 placeholder-[#696969] focus:ring-0 focus:outline-none focus:appearance-none" placeholder="Email">
                        <textarea v-model="form.msg" class="rounded-[10px] bg-[#EBEBEB] border border-[#B1B1B1] text-base py-2.5 px-5 placeholder-[#696969] focus:ring-0 focus:outline-none focus:appearance-none resize-none h-24" placeholder="Текст вопроса"></textarea>
                        <button class="text-white font-normal bg-gradient-to-r from-[#48BBDE] to-[#B190F1] rounded-[10px] text-center text-xl md:text-xl xl:text-2xl py-3 w-full">Отправить</button>
                        <button type="button" @click="message.title = null" class="fixed top-10 right-10 z-[41] cursor-pointer flex items-center gap-4 px-6 py-2 rounded-2xl w-fit text-[#131313] bg-white dark:text-white dark:bg-[#131313]" :class="message.type ? 'shadow-[0_0_20px_-7px]' : 'bg-red-500'" v-if="message.title">
                            <span>{{message.title}}</span>
                            <Icon name="material-symbols:close-rounded" class="text-xl"/>
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <ClientOnly>
            <div class="px-6 md:px-12 xl:px-[90px]">
                <div class="rounded-[15px] p-px bg-gradient-to-tl from-[#48BBDE] to-[#B190F1]">
                    <div class="w-full h-full bg-white rounded-[15px] overflow-hidden">
                        <YandexMap :coordinates="[55.726407, 37.399455]" :zoom="17">
                            <YandexMarker :coordinates="[55.726407, 37.399455]" :marker-id="12345">
                                <template #component>
                                    <div class="flex flex-col h-fit gap-2">
                                        <p class="font-medium text-lg">Офис</p>
                                        <p>г. Москва, муниципальный округ Можайский вн.тер.г., ул. Горбунова, д. 2, стр. 3, помещение 55/3</p>
                                    </div>
                                </template>
                            </YandexMarker>
                        </YandexMap>
                    </div>
                </div>
            </div>
        </ClientOnly>
    </div>
</template>

<script setup>
    import { yandexMap, yandexMarker } from 'vue-yandex-maps'

    const form = ref({
        name: "",
        email: "",
        msg: ""
    })

    const token = "6478570357:AAHRiEm9vOmK0oVMzoVAbxMGxIZl1NK86oc"
    const chat_id = "-4029823062"
    const URL = `https://api.telegram.org/bot${token}/sendMessage`

    let message = ref({title:null, type:true})

    const submitForm = async () => {
        let msg = "<b>Сообщение с сайта!</b>\n"
        + `<b>Имя:</b> ${form.value.name}\n`
        + `<b>Email:</b> ${form.value.email}\n`
        + `<b>Вопрос:</b> ${form.value.msg}\n` 
        const {data, error} = await useFetch(URL,{
            body:{
                'chat_id': chat_id,
                'parse_mode': 'html',
                'text': msg
            },
            method:'post'        
	    })
        if (error.value) return message.value.title = 'При отправке произошла ошибка!', message.value.type = false
	    message.value.title = 'Успешная отправка!', message.value.type = true 
        form.value.name = ""
        form.value.email = ""
        form.value.msg = ""
        setTimeout(() => {
            message.value.title = null
        }, 3000);
    }
</script>

<style>
    .yandex-container {
        height: 400px;
    }
    .yandex-balloon {
        height: 100px;
        width: 275px;
    }
</style>